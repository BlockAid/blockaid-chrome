{"version":3,"sources":["../scripts.babel/background.js"],"names":[],"mappings":"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","file":"background.js","sourcesContent":["'use strict';\n\nfunction init() {\n    var blockList;\n    blockList = JSON.parse(localStorage.getItem('manualBlockList') || '[{\"domain\":\"use.typekit.net\",\"enabled\":true},{\"domain\":\"googleapis.com\",\"enabled\":true}]'); // jshint ignore:line\n    localStorage.setItem('manualBlockList', JSON.stringify(blockList));\n}\n\nfunction checkUrl(url) {\n    var i, todoitems;\n    todoitems = [];\n    if (localStorage.getItem('mode') === 'true') {\n        todoitems = JSON.parse(localStorage.getItem('autoBlockList') || '[]');\n    } else {\n        todoitems = JSON.parse(localStorage.getItem('manualBlockList') || '[]');\n    }\n    i = void 0;\n    i = 0;\n    while (i < todoitems.length) {\n        if (todoitems[i].enabled) {\n            if (url.match(new RegExp('http(s)?://.*' + todoitems[i].domain + '.*')) !== null) {\n                return true;\n            }\n        }\n        i++;\n    }\n    return false;\n}\n\nfunction stripTrailingSlashAndProtocol(str) {\n    var a;\n    a = document.createElement('a');\n    a.href = str;\n    return a.hostname;\n}\n\n\nfunction onInstalled(details) {\n    console.log('previousVersion', details.previousVersion);\n}\n\nfunction onMessage(message, sender, sendResponse) {// jshint ignore:line\n    if (message.method === 'changeIcon') {\n        chrome.browserAction.setIcon({\n            path: message.newIconPath\n        });\n    }\n}\n\nfunction onErrorOccurred(details) {\n    var arr, i, key, todoitems;\n    if (details) {\n        console.log(details);\n        if (details.error === 'net::ERR_CONNECTION_TIMED_OUT' || details.error === 'net::ERR_TIMED_OUT' || details.error === 'net::ERR_NAME_NOT_RESOLVED') {\n            todoitems = JSON.parse(localStorage.getItem('autoBlockList') || '{}');\n            todoitems.push({\n                domain: stripTrailingSlashAndProtocol(details.url),// jshint ignore:line\n                enabled: true// jshint ignore:line\n            });\n            arr = {};\n            i = 0;\n            while (i < todoitems.length) {\n                arr[todoitems[i].domain] = todoitems[i];\n                i++;\n            }\n            todoitems = [];\n            for (key in arr) {\n                todoitems.push(arr[key]);\n            }\n            localStorage.setItem('autoBlockList', JSON.stringify(todoitems));\n        }\n    }\n}\n\nfunction onBeforeRequest(details) {\n    if (localStorage.getItem('status') === 'true') {\n        return {\n            cancel: checkUrl(details.url) !== false\n        };\n    }\n}\n\ninit();\n\n\nchrome.runtime.onMessage.addListener(onMessage);\nchrome.runtime.onInstalled.addListener(onInstalled);\n\nchrome.webRequest.onErrorOccurred.addListener(onErrorOccurred, {urls: ['<all_urls>']});\nchrome.webRequest.onBeforeRequest.addListener(onBeforeRequest, {urls: ['<all_urls>']}, ['blocking']);\n\nchrome.browserAction.setBadgeText({text: 'Dev'});\n\nconsole.log('\\'Allo \\'Allo! Event Page for Browser Action');"]}